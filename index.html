<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">

    <meta name="viewport"
          content="width=device-width,user-scalable=no">

    <!-- MindAR + A-Frame -->
    <script src="https://cdn.jsdelivr.net/npm/aframe@1.5.0/dist/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.5/dist/mindar-image-aframe.prod.js"></script>
</head>

<body style="margin:0; overflow:hidden">

<!-- ОБЯЗАТЕЛЬНО — прямой пользовательский клик -->
<button id="startAR"
        style="position:absolute;z-index:999;
               width:100%;height:70px;font-size:20px;">
START AR
</button>

<a-scene
    mindar-image="imageTargetSrc: ./targets.mind; autoStart: false"
    embedded
    vr-mode-ui="enabled:false"
    device-orientation-permission-ui="enabled:false">

    <a-camera></a-camera>

    <a-entity id="target"
              mindar-image-target="targetIndex: 0">

        <a-box position="0 0 0" color="orange"></a-box>

    </a-entity>

</a-scene>

<script>
document.getElementById("startAR").onclick = async () => {

    /* единственный корректный способ запуска */

    const scene = document.querySelector("a-scene");
    const arSystem = scene.systems["mindar-image-system"];

    try {
        await arSystem.start();
        document.getElementById("startAR").remove();
        console.log("✅ CAMERA STARTED");

    } catch(e){
        alert("❌ CAMERA ERROR:\n" + e.message);
        console.error(e);
    }
}
</script>

</body>
</html>
